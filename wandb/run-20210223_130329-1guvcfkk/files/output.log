GPU detected
WARNING:tensorflow:No training configuration found in save file, so the model was *not* compiled. Compile it manually.
Loading data to memory
  0%|                                                   | 0/391 [00:00<?, ?it/s][0;31m---------------------------------------------------------------------------[0m
[0;31mInvalidArgumentError[0m                      Traceback (most recent call last)
[0;32m~/Desktop/IceCube_GNN/train_classification.py[0m in [0;36m<module>[0;34m[0m
[1;32m    282[0m [0;34m[0m[0m
[1;32m    283[0m [0;34m[0m[0m
[0;32m--> 284[0;31m [0mtest[0m[0;34m([0m[0mloader_test[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    285[0m [0;31m# fig.savefig(f"model_tests/{model_name}_test.pdf")[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/Desktop/IceCube_GNN/train_classification.py[0m in [0;36mtest[0;34m(loader)[0m
[1;32m    192[0m         [0mloss[0m           [0;34m+=[0m [0mout[0m[0;34m[0m[0;34m[0m[0m
[1;32m    193[0m [0;34m[0m[0m
[0;32m--> 194[0;31m         [0my[0m[0;34m,[0m [0midx[0m[0;34m,[0m [0mcount[0m [0;34m=[0m [0mtf[0m[0;34m.[0m[0munique_with_counts[0m[0;34m([0m[0mbatch[0m[0;34m[[0m[0;36m0[0m[0;34m][0m[0;34m[[0m[0;36m0[0m[0;34m][0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    195[0m [0;34m[0m[0m
[1;32m    196[0m         [0mN_nodes[0m[0;34m.[0m[0mappend[0m[0;34m([0m[0mcount[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py[0m in [0;36mwrapper[0;34m(*args, **kwargs)[0m
[1;32m    199[0m     [0;34m"""Call target, and fall back on dispatchers if there is a TypeError."""[0m[0;34m[0m[0;34m[0m[0m
[1;32m    200[0m     [0;32mtry[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 201[0;31m       [0;32mreturn[0m [0mtarget[0m[0;34m([0m[0;34m*[0m[0margs[0m[0;34m,[0m [0;34m**[0m[0mkwargs[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    202[0m     [0;32mexcept[0m [0;34m([0m[0mTypeError[0m[0;34m,[0m [0mValueError[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    203[0m       [0;31m# Note: convert_to_eager_tensor currently raises a ValueError, not a[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/tensorflow/python/ops/array_ops.py[0m in [0;36munique_with_counts[0;34m(x, out_idx, name)[0m
[1;32m   1971[0m   [0;31m# TODO(yongtang): The documentation should also[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[1;32m   1972[0m   [0;31m# be updated when switch  to v2.[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[0;32m-> 1973[0;31m   [0;32mreturn[0m [0mgen_array_ops[0m[0;34m.[0m[0munique_with_counts[0m[0;34m([0m[0mx[0m[0;34m,[0m [0mout_idx[0m[0;34m,[0m [0mname[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m   1974[0m [0;34m[0m[0m
[1;32m   1975[0m [0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/tensorflow/python/ops/gen_array_ops.py[0m in [0;36munique_with_counts[0;34m(x, out_idx, name)[0m
[1;32m  11879[0m       [0;32mreturn[0m [0m_result[0m[0;34m[0m[0;34m[0m[0m
[1;32m  11880[0m     [0;32mexcept[0m [0m_core[0m[0;34m.[0m[0m_NotOkStatusException[0m [0;32mas[0m [0me[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m> 11881[0;31m       [0m_ops[0m[0;34m.[0m[0mraise_from_not_ok_status[0m[0;34m([0m[0me[0m[0;34m,[0m [0mname[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m  11882[0m     [0;32mexcept[0m [0m_core[0m[0;34m.[0m[0m_FallbackException[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m  11883[0m       [0;32mpass[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/tensorflow/python/framework/ops.py[0m in [0;36mraise_from_not_ok_status[0;34m(e, name)[0m
[1;32m   6860[0m   [0mmessage[0m [0;34m=[0m [0me[0m[0;34m.[0m[0mmessage[0m [0;34m+[0m [0;34m([0m[0;34m" name: "[0m [0;34m+[0m [0mname[0m [0;32mif[0m [0mname[0m [0;32mis[0m [0;32mnot[0m [0;32mNone[0m [0;32melse[0m [0;34m""[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m   6861[0m   [0;31m# pylint: disable=protected-access[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[0;32m-> 6862[0;31m   [0msix[0m[0;34m.[0m[0mraise_from[0m[0;34m([0m[0mcore[0m[0;34m.[0m[0m_status_to_exception[0m[0;34m([0m[0me[0m[0;34m.[0m[0mcode[0m[0;34m,[0m [0mmessage[0m[0;34m)[0m[0;34m,[0m [0;32mNone[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m   6863[0m   [0;31m# pylint: enable=protected-access[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[1;32m   6864[0m [0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/six.py[0m in [0;36mraise_from[0;34m(value, from_value)[0m

[0;31mInvalidArgumentError[0m: unique expects a 1D vector. [Op:UniqueWithCounts]

[0;31m---------------------------------------------------------------------------[0m
[0;31mNameError[0m                                 Traceback (most recent call last)
[0;32m<ipython-input-2-c92514436851>[0m in [0;36m<module>[0;34m[0m
[0;32m----> 1[0;31m [0mbatch[0m[0;34m[[0m[0;36m0[0m[0;34m][0m[0;34m[0m[0;34m[0m[0m
[0m
[0;31mNameError[0m: name 'batch' is not defined

[0;31m---------------------------------------------------------------------------[0m
[0;31mNameError[0m                                 Traceback (most recent call last)
[0;32m<ipython-input-3-0e20a88bbe2e>[0m in [0;36m<module>[0;34m[0m
[0;32m----> 1[0;31m [0mbatch[0m[0;34m[0m[0;34m[0m[0m
[0m
[0;31mNameError[0m: name 'batch' is not defined


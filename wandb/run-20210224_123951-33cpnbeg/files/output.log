GPU detected
Loading data to memory
  0%|                                                    | 0/79 [00:00<?, ?it/s]WARNING:tensorflow:Gradients do not exist for variables ['model/dense_3/kernel:0', 'model/dense_3/bias:0', 'model/dense_6/kernel:0', 'model/dense_6/bias:0'] when minimizing the loss.
WARNING:tensorflow:Gradients do not exist for variables ['model/dense_3/kernel:0', 'model/dense_3/bias:0', 'model/dense_6/kernel:0', 'model/dense_6/bias:0'] when minimizing the loss.
  1%|▌                                           | 1/79 [00:05<07:12,  5.54s/it]Epoch 1 / 100; Avg_loss: 2.740601:   1%|         | 1/79 [00:05<07:12,  5.54s/it]Epoch 1 / 100; Avg_loss: 2.740601:   3%|▏        | 2/79 [00:06<05:20,  4.16s/it]Epoch 1 / 100; Avg_loss: 2.668598:   3%|▏        | 2/79 [00:06<05:20,  4.16s/it]Epoch 1 / 100; Avg_loss: 2.668598:   4%|▎        | 3/79 [00:07<04:00,  3.16s/it]Epoch 1 / 100; Avg_loss: 2.634670:   4%|▎        | 3/79 [00:07<04:00,  3.16s/it]Epoch 1 / 100; Avg_loss: 2.634670:   5%|▍        | 4/79 [00:08<03:05,  2.47s/it]Epoch 1 / 100; Avg_loss: 2.617692:   5%|▍        | 4/79 [00:08<03:05,  2.47s/it]Epoch 1 / 100; Avg_loss: 2.617692:   6%|▌        | 5/79 [00:09<02:27,  1.99s/it]Epoch 1 / 100; Avg_loss: 2.579772:   6%|▌        | 5/79 [00:09<02:27,  1.99s/it]Epoch 1 / 100; Avg_loss: 2.579772:   8%|▋        | 6/79 [00:09<02:00,  1.65s/it]Epoch 1 / 100; Avg_loss: 2.545852:   8%|▋        | 6/79 [00:09<02:00,  1.65s/it]Epoch 1 / 100; Avg_loss: 2.545852:   9%|▊        | 7/79 [00:10<01:41,  1.41s/it]Epoch 1 / 100; Avg_loss: 2.514151:   9%|▊        | 7/79 [00:10<01:41,  1.41s/it]Epoch 1 / 100; Avg_loss: 2.514151:  10%|▉        | 8/79 [00:11<01:28,  1.24s/it]Epoch 1 / 100; Avg_loss: 2.483503:  10%|▉        | 8/79 [00:11<01:28,  1.24s/it]Epoch 1 / 100; Avg_loss: 2.483503:  11%|█        | 9/79 [00:12<01:18,  1.13s/it]Epoch 1 / 100; Avg_loss: 2.457684:  11%|█        | 9/79 [00:12<01:18,  1.13s/it]Epoch 1 / 100; Avg_loss: 2.457684:  13%|█       | 10/79 [00:13<01:12,  1.04s/it]Epoch 1 / 100; Avg_loss: 2.441009:  13%|█       | 10/79 [00:13<01:12,  1.04s/it]Epoch 1 / 100; Avg_loss: 2.441009:  14%|█       | 11/79 [00:14<01:07,  1.01it/s]Epoch 1 / 100; Avg_loss: 2.417425:  14%|█       | 11/79 [00:14<01:07,  1.01it/s]Epoch 1 / 100; Avg_loss: 2.417425:  15%|█▏      | 12/79 [00:14<01:03,  1.06it/s]Epoch 1 / 100; Avg_loss: 2.407309:  15%|█▏      | 12/79 [00:14<01:03,  1.06it/s]Epoch 1 / 100; Avg_loss: 2.407309:  16%|█▎      | 13/79 [00:15<01:00,  1.10it/s]Epoch 1 / 100; Avg_loss: 2.384619:  16%|█▎      | 13/79 [00:15<01:00,  1.10it/s]Epoch 1 / 100; Avg_loss: 2.384619:  18%|█▍      | 14/79 [00:16<00:57,  1.12it/s]Epoch 1 / 100; Avg_loss: 2.368943:  18%|█▍      | 14/79 [00:16<00:57,  1.12it/s]Epoch 1 / 100; Avg_loss: 2.368943:  19%|█▌      | 15/79 [00:17<00:56,  1.14it/s]Epoch 1 / 100; Avg_loss: 2.354597:  19%|█▌      | 15/79 [00:17<00:56,  1.14it/s]Epoch 1 / 100; Avg_loss: 2.354597:  20%|█▌      | 16/79 [00:18<00:54,  1.15it/s]Epoch 1 / 100; Avg_loss: 2.334449:  20%|█▌      | 16/79 [00:18<00:54,  1.15it/s]Epoch 1 / 100; Avg_loss: 2.334449:  22%|█▋      | 17/79 [00:19<00:53,  1.16it/s]Epoch 1 / 100; Avg_loss: 2.315150:  22%|█▋      | 17/79 [00:19<00:53,  1.16it/s]Epoch 1 / 100; Avg_loss: 2.315150:  23%|█▊      | 18/79 [00:20<00:52,  1.17it/s]Epoch 1 / 100; Avg_loss: 2.307367:  23%|█▊      | 18/79 [00:20<00:52,  1.17it/s]Epoch 1 / 100; Avg_loss: 2.307367:  24%|█▉      | 19/79 [00:20<00:51,  1.17it/s]Epoch 1 / 100; Avg_loss: 2.290552:  24%|█▉      | 19/79 [00:20<00:51,  1.17it/s]Epoch 1 / 100; Avg_loss: 2.290552:  25%|██      | 20/79 [00:21<00:50,  1.16it/s]Epoch 1 / 100; Avg_loss: 2.274522:  25%|██      | 20/79 [00:21<00:50,  1.16it/s]Epoch 1 / 100; Avg_loss: 2.274522:  27%|██▏     | 21/79 [00:22<00:49,  1.17it/s]Epoch 1 / 100; Avg_loss: 2.254163:  27%|██▏     | 21/79 [00:22<00:49,  1.17it/s]Epoch 1 / 100; Avg_loss: 2.254163:  28%|██▏     | 22/79 [00:23<00:48,  1.17it/s]Epoch 1 / 100; Avg_loss: 2.243641:  28%|██▏     | 22/79 [00:23<00:48,  1.17it/s]Epoch 1 / 100; Avg_loss: 2.243641:  29%|██▎     | 23/79 [00:24<00:47,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.225380:  29%|██▎     | 23/79 [00:24<00:47,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.225380:  30%|██▍     | 24/79 [00:25<00:46,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.211900:  30%|██▍     | 24/79 [00:25<00:46,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.211900:  32%|██▌     | 25/79 [00:25<00:45,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.197246:  32%|██▌     | 25/79 [00:25<00:45,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.197246:  33%|██▋     | 26/79 [00:26<00:44,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.182912:  33%|██▋     | 26/79 [00:26<00:44,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.182912:  34%|██▋     | 27/79 [00:27<00:43,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.166099:  34%|██▋     | 27/79 [00:27<00:43,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.166099:  35%|██▊     | 28/79 [00:28<00:43,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.154527:  35%|██▊     | 28/79 [00:28<00:43,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.154527:  37%|██▉     | 29/79 [00:29<00:42,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.142160:  37%|██▉     | 29/79 [00:29<00:42,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.142160:  38%|███     | 30/79 [00:30<00:41,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.131680:  38%|███     | 30/79 [00:30<00:41,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.131680:  39%|███▏    | 31/79 [00:31<00:40,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.119924:  39%|███▏    | 31/79 [00:31<00:40,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.119924:  41%|███▏    | 32/79 [00:31<00:39,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.114384:  41%|███▏    | 32/79 [00:31<00:39,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.114384:  42%|███▎    | 33/79 [00:32<00:38,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.102589:  42%|███▎    | 33/79 [00:32<00:38,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.102589:  43%|███▍    | 34/79 [00:33<00:37,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.090630:  43%|███▍    | 34/79 [00:33<00:37,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.090630:  44%|███▌    | 35/79 [00:34<00:36,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.079774:  44%|███▌    | 35/79 [00:34<00:36,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.079774:  46%|███▋    | 36/79 [00:35<00:35,  1.20it/s]Epoch 1 / 100; Avg_loss: 2.069012:  46%|███▋    | 36/79 [00:35<00:35,  1.20it/s]Epoch 1 / 100; Avg_loss: 2.069012:  47%|███▋    | 37/79 [00:36<00:35,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.058811:  47%|███▋    | 37/79 [00:36<00:35,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.058811:  48%|███▊    | 38/79 [00:36<00:34,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.051713:  48%|███▊    | 38/79 [00:36<00:34,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.051713:  49%|███▉    | 39/79 [00:37<00:33,  1.20it/s]Epoch 1 / 100; Avg_loss: 2.043278:  49%|███▉    | 39/79 [00:37<00:33,  1.20it/s]Epoch 1 / 100; Avg_loss: 2.043278:  51%|████    | 40/79 [00:38<00:32,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.033119:  51%|████    | 40/79 [00:38<00:32,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.033119:  52%|████▏   | 41/79 [00:39<00:31,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.023425:  52%|████▏   | 41/79 [00:39<00:31,  1.19it/s]Epoch 1 / 100; Avg_loss: 2.023425:  53%|████▎   | 42/79 [00:40<00:31,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.015432:  53%|████▎   | 42/79 [00:40<00:31,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.015432:  54%|████▎   | 43/79 [00:41<00:30,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.006716:  54%|████▎   | 43/79 [00:41<00:30,  1.18it/s]Epoch 1 / 100; Avg_loss: 2.006716:  56%|████▍   | 44/79 [00:41<00:29,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.997866:  56%|████▍   | 44/79 [00:41<00:29,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.997866:  57%|████▌   | 45/79 [00:42<00:28,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.990729:  57%|████▌   | 45/79 [00:42<00:28,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.990729:  58%|████▋   | 46/79 [00:43<00:28,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.980690:  58%|████▋   | 46/79 [00:43<00:28,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.980690:  59%|████▊   | 47/79 [00:44<00:27,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.970664:  59%|████▊   | 47/79 [00:44<00:27,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.970664:  61%|████▊   | 48/79 [00:45<00:26,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.961638:  61%|████▊   | 48/79 [00:45<00:26,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.961638:  62%|████▉   | 49/79 [00:46<00:25,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.952867:  62%|████▉   | 49/79 [00:46<00:25,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.952867:  63%|█████   | 50/79 [00:47<00:24,  1.16it/s]Epoch 1 / 100; Avg_loss: 1.944194:  63%|█████   | 50/79 [00:47<00:24,  1.16it/s]Epoch 1 / 100; Avg_loss: 1.944194:  65%|█████▏  | 51/79 [00:47<00:24,  1.16it/s]Epoch 1 / 100; Avg_loss: 1.936383:  65%|█████▏  | 51/79 [00:48<00:24,  1.16it/s]Epoch 1 / 100; Avg_loss: 1.936383:  66%|█████▎  | 52/79 [00:48<00:23,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.929196:  66%|█████▎  | 52/79 [00:48<00:23,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.929196:  67%|█████▎  | 53/79 [00:49<00:22,  1.14it/s]Epoch 1 / 100; Avg_loss: 1.923297:  67%|█████▎  | 53/79 [00:49<00:22,  1.14it/s]Epoch 1 / 100; Avg_loss: 1.923297:  68%|█████▍  | 54/79 [00:50<00:21,  1.16it/s]Epoch 1 / 100; Avg_loss: 1.914339:  68%|█████▍  | 54/79 [00:50<00:21,  1.16it/s]Epoch 1 / 100; Avg_loss: 1.914339:  70%|█████▌  | 55/79 [00:51<00:20,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.906581:  70%|█████▌  | 55/79 [00:51<00:20,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.906581:  71%|█████▋  | 56/79 [00:52<00:19,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.898786:  71%|█████▋  | 56/79 [00:52<00:19,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.898786:  72%|█████▊  | 57/79 [00:53<00:18,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.889635:  72%|█████▊  | 57/79 [00:53<00:18,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.889635:  73%|█████▊  | 58/79 [00:53<00:17,  1.19it/s]Epoch 1 / 100; Avg_loss: 1.882343:  73%|█████▊  | 58/79 [00:53<00:17,  1.19it/s]Epoch 1 / 100; Avg_loss: 1.882343:  75%|█████▉  | 59/79 [00:54<00:17,  1.16it/s]Epoch 1 / 100; Avg_loss: 1.874711:  75%|█████▉  | 59/79 [00:54<00:17,  1.16it/s]Epoch 1 / 100; Avg_loss: 1.874711:  76%|██████  | 60/79 [00:55<00:16,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.867770:  76%|██████  | 60/79 [00:55<00:16,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.867770:  77%|██████▏ | 61/79 [00:56<00:15,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.861697:  77%|██████▏ | 61/79 [00:56<00:15,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.861697:  78%|██████▎ | 62/79 [00:57<00:14,  1.16it/s]Epoch 1 / 100; Avg_loss: 1.856609:  78%|██████▎ | 62/79 [00:57<00:14,  1.16it/s]Epoch 1 / 100; Avg_loss: 1.856609:  80%|██████▍ | 63/79 [00:58<00:13,  1.16it/s]Epoch 1 / 100; Avg_loss: 1.847578:  80%|██████▍ | 63/79 [00:58<00:13,  1.16it/s]Epoch 1 / 100; Avg_loss: 1.847578:  81%|██████▍ | 64/79 [00:59<00:12,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.840363:  81%|██████▍ | 64/79 [00:59<00:12,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.840363:  82%|██████▌ | 65/79 [00:59<00:11,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.834097:  82%|██████▌ | 65/79 [00:59<00:11,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.834097:  84%|██████▋ | 66/79 [01:00<00:11,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.826784:  84%|██████▋ | 66/79 [01:00<00:11,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.826784:  85%|██████▊ | 67/79 [01:01<00:10,  1.19it/s]Epoch 1 / 100; Avg_loss: 1.819692:  85%|██████▊ | 67/79 [01:01<00:10,  1.19it/s]Epoch 1 / 100; Avg_loss: 1.819692:  86%|██████▉ | 68/79 [01:02<00:09,  1.16it/s]Epoch 1 / 100; Avg_loss: 1.812294:  86%|██████▉ | 68/79 [01:02<00:09,  1.16it/s]Epoch 1 / 100; Avg_loss: 1.812294:  87%|██████▉ | 69/79 [01:03<00:08,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.807000:  87%|██████▉ | 69/79 [01:03<00:08,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.807000:  89%|███████ | 70/79 [01:04<00:07,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.800859:  89%|███████ | 70/79 [01:04<00:07,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.800859:  90%|███████▏| 71/79 [01:05<00:06,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.795923:  90%|███████▏| 71/79 [01:05<00:06,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.795923:  91%|███████▎| 72/79 [01:05<00:05,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.789820:  91%|███████▎| 72/79 [01:05<00:05,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.789820:  92%|███████▍| 73/79 [01:06<00:05,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.784378:  92%|███████▍| 73/79 [01:06<00:05,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.784378:  94%|███████▍| 74/79 [01:07<00:04,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.777387:  94%|███████▍| 74/79 [01:07<00:04,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.777387:  95%|███████▌| 75/79 [01:08<00:03,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.772621:  95%|███████▌| 75/79 [01:08<00:03,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.772621:  96%|███████▋| 76/79 [01:09<00:02,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.768151:  96%|███████▋| 76/79 [01:09<00:02,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.768151:  97%|███████▊| 77/79 [01:10<00:01,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.762775:  97%|███████▊| 77/79 [01:10<00:01,  1.17it/s]Epoch 1 / 100; Avg_loss: 1.762775:  99%|███████▉| 78/79 [01:11<00:00,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.757816:  99%|███████▉| 78/79 [01:11<00:00,  1.18it/s]Epoch 1 / 100; Avg_loss: 1.757816: 100%|████████| 79/79 [01:11<00:00,  1.41it/s]Epoch 1 / 100; Avg_loss: 1.746546: 100%|████████| 79/79 [01:11<00:00,  1.41it/s]Epoch 1 of 100 done in 71.41 seconds using learning rate: 1.00E-04
Avg loss of train: 1.746546
Avg loss of validation: 0.964223, Angle_metric: 90.301666
Epoch 1 / 100; Avg_loss: 1.746546:   0%|         | 0/79 [01:16<00:56,  1.41it/s]Epoch 1 / 100; Avg_loss: 1.746546:   1%|         | 1/79 [01:17<03:08,  2.42s/it]Epoch 2 / 100; Avg_loss: 1.357520:   1%|         | 1/79 [01:17<03:08,  2.42s/it]Epoch 2 / 100; Avg_loss: 1.357520:   3%|▏        | 2/79 [01:18<02:29,  1.94s/it]Epoch 2 / 100; Avg_loss: 1.345463:   3%|▏        | 2/79 [01:18<02:29,  1.94s/it]Epoch 2 / 100; Avg_loss: 1.345463:   4%|▎        | 3/79 [01:19<02:02,  1.61s/it]Epoch 2 / 100; Avg_loss: 1.353744:   4%|▎        | 3/79 [01:19<02:02,  1.61s/it]Epoch 2 / 100; Avg_loss: 1.353744:   5%|▍        | 4/79 [01:20<01:43,  1.38s/it]Epoch 2 / 100; Avg_loss: 1.331017:   5%|▍        | 4/79 [01:20<01:43,  1.38s/it]Epoch 2 / 100; Avg_loss: 1.331017:   6%|▌        | 5/79 [01:21<01:30,  1.22s/it]Epoch 2 / 100; Avg_loss: 1.323357:   6%|▌        | 5/79 [01:21<01:30,  1.22s/it]Epoch 2 / 100; Avg_loss: 1.323357:   8%|▋        | 6/79 [01:22<01:22,  1.12s/it]Epoch 2 / 100; Avg_loss: 1.312047:   8%|▋        | 6/79 [01:22<01:22,  1.12s/it]Epoch 2 / 100; Avg_loss: 1.312047:   9%|▊        | 7/79 [01:22<01:14,  1.04s/it]Epoch 2 / 100; Avg_loss: 1.293772:   9%|▊        | 7/79 [01:22<01:14,  1.04s/it]Epoch 2 / 100; Avg_loss: 1.293772:  10%|▉        | 8/79 [01:23<01:09,  1.02it/s]Epoch 2 / 100; Avg_loss: 1.295324:  10%|▉        | 8/79 [01:23<01:09,  1.02it/s]Epoch 2 / 100; Avg_loss: 1.295324:  11%|█        | 9/79 [01:24<01:05,  1.06it/s]Epoch 2 / 100; Avg_loss: 1.285183:  11%|█        | 9/79 [01:24<01:05,  1.06it/s]Epoch 2 / 100; Avg_loss: 1.285183:  13%|█       | 10/79 [01:25<01:02,  1.10it/s]Epoch 2 / 100; Avg_loss: 1.271280:  13%|█       | 10/79 [01:25<01:02,  1.10it/s]Epoch 2 / 100; Avg_loss: 1.271280:  14%|█       | 11/79 [01:26<00:59,  1.13it/s]Epoch 2 / 100; Avg_loss: 1.264905:  14%|█       | 11/79 [01:26<00:59,  1.13it/s]Epoch 2 / 100; Avg_loss: 1.264905:  15%|█▏      | 12/79 [01:27<00:58,  1.15it/s]Epoch 2 / 100; Avg_loss: 1.253539:  15%|█▏      | 12/79 [01:27<00:58,  1.15it/s]Epoch 2 / 100; Avg_loss: 1.253539:  16%|█▎      | 13/79 [01:27<00:56,  1.16it/s]Epoch 2 / 100; Avg_loss: 1.246668:  16%|█▎      | 13/79 [01:27<00:56,  1.16it/s]Epoch 2 / 100; Avg_loss: 1.246668:  18%|█▍      | 14/79 [01:28<00:55,  1.17it/s]Epoch 2 / 100; Avg_loss: 1.230621:  18%|█▍      | 14/79 [01:28<00:55,  1.17it/s]Epoch 2 / 100; Avg_loss: 1.230621:  19%|█▌      | 15/79 [01:29<00:54,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.220093:  19%|█▌      | 15/79 [01:29<00:54,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.220093:  20%|█▌      | 16/79 [01:30<00:59,  1.06it/s]Epoch 2 / 100; Avg_loss: 1.214121:  20%|█▌      | 16/79 [01:30<00:59,  1.06it/s]Epoch 2 / 100; Avg_loss: 1.214121:  22%|█▋      | 17/79 [01:31<00:56,  1.10it/s]Epoch 2 / 100; Avg_loss: 1.206807:  22%|█▋      | 17/79 [01:31<00:56,  1.10it/s]Epoch 2 / 100; Avg_loss: 1.206807:  23%|█▊      | 18/79 [01:32<00:54,  1.12it/s]Epoch 2 / 100; Avg_loss: 1.201348:  23%|█▊      | 18/79 [01:32<00:54,  1.12it/s]Epoch 2 / 100; Avg_loss: 1.201348:  24%|█▉      | 19/79 [01:33<00:52,  1.14it/s]Epoch 2 / 100; Avg_loss: 1.188596:  24%|█▉      | 19/79 [01:33<00:52,  1.14it/s]Epoch 2 / 100; Avg_loss: 1.188596:  25%|██      | 20/79 [01:34<00:51,  1.15it/s]Epoch 2 / 100; Avg_loss: 1.176199:  25%|██      | 20/79 [01:34<00:51,  1.15it/s]Epoch 2 / 100; Avg_loss: 1.176199:  27%|██▏     | 21/79 [01:35<00:50,  1.15it/s]Epoch 2 / 100; Avg_loss: 1.165200:  27%|██▏     | 21/79 [01:35<00:50,  1.15it/s]Epoch 2 / 100; Avg_loss: 1.165200:  28%|██▏     | 22/79 [01:35<00:49,  1.15it/s]Epoch 2 / 100; Avg_loss: 1.159247:  28%|██▏     | 22/79 [01:35<00:49,  1.15it/s]Epoch 2 / 100; Avg_loss: 1.159247:  29%|██▎     | 23/79 [01:36<00:47,  1.17it/s]Epoch 2 / 100; Avg_loss: 1.150957:  29%|██▎     | 23/79 [01:36<00:47,  1.17it/s]Epoch 2 / 100; Avg_loss: 1.150957:  30%|██▍     | 24/79 [01:37<00:46,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.143481:  30%|██▍     | 24/79 [01:37<00:46,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.143481:  32%|██▌     | 25/79 [01:38<00:45,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.134712:  32%|██▌     | 25/79 [01:38<00:45,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.134712:  33%|██▋     | 26/79 [01:39<00:44,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.125996:  33%|██▋     | 26/79 [01:39<00:44,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.125996:  34%|██▋     | 27/79 [01:40<00:43,  1.19it/s]Epoch 2 / 100; Avg_loss: 1.117841:  34%|██▋     | 27/79 [01:40<00:43,  1.19it/s]Epoch 2 / 100; Avg_loss: 1.117841:  35%|██▊     | 28/79 [01:40<00:43,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.107134:  35%|██▊     | 28/79 [01:40<00:43,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.107134:  37%|██▉     | 29/79 [01:41<00:42,  1.19it/s]Epoch 2 / 100; Avg_loss: 1.099108:  37%|██▉     | 29/79 [01:41<00:42,  1.19it/s]Epoch 2 / 100; Avg_loss: 1.099108:  38%|███     | 30/79 [01:42<00:41,  1.19it/s]Epoch 2 / 100; Avg_loss: 1.091219:  38%|███     | 30/79 [01:42<00:41,  1.19it/s]Epoch 2 / 100; Avg_loss: 1.091219:  39%|███▏    | 31/79 [01:43<00:40,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.082501:  39%|███▏    | 31/79 [01:43<00:40,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.082501:  41%|███▏    | 32/79 [01:44<00:39,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.074533:  41%|███▏    | 32/79 [01:44<00:39,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.074533:  42%|███▎    | 33/79 [01:45<00:38,  1.19it/s]Epoch 2 / 100; Avg_loss: 1.067117:  42%|███▎    | 33/79 [01:45<00:38,  1.19it/s]Epoch 2 / 100; Avg_loss: 1.067117:  43%|███▍    | 34/79 [01:45<00:38,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.059186:  43%|███▍    | 34/79 [01:45<00:38,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.059186:  44%|███▌    | 35/79 [01:46<00:37,  1.19it/s]Epoch 2 / 100; Avg_loss: 1.049241:  44%|███▌    | 35/79 [01:46<00:37,  1.19it/s]Epoch 2 / 100; Avg_loss: 1.049241:  46%|███▋    | 36/79 [01:47<00:35,  1.20it/s]Epoch 2 / 100; Avg_loss: 1.038773:  46%|███▋    | 36/79 [01:47<00:35,  1.20it/s]Epoch 2 / 100; Avg_loss: 1.038773:  47%|███▋    | 37/79 [01:48<00:35,  1.19it/s]Epoch 2 / 100; Avg_loss: 1.029966:  47%|███▋    | 37/79 [01:48<00:35,  1.19it/s]Epoch 2 / 100; Avg_loss: 1.029966:  48%|███▊    | 38/79 [01:49<00:34,  1.19it/s]Epoch 2 / 100; Avg_loss: 1.023136:  48%|███▊    | 38/79 [01:49<00:34,  1.19it/s]Epoch 2 / 100; Avg_loss: 1.023136:  49%|███▉    | 39/79 [01:50<00:33,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.015709:  49%|███▉    | 39/79 [01:50<00:33,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.015709:  51%|████    | 40/79 [01:51<00:33,  1.17it/s]Epoch 2 / 100; Avg_loss: 1.011762:  51%|████    | 40/79 [01:51<00:33,  1.17it/s]Epoch 2 / 100; Avg_loss: 1.011762:  52%|████▏   | 41/79 [01:51<00:32,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.003881:  52%|████▏   | 41/79 [01:51<00:32,  1.18it/s]Epoch 2 / 100; Avg_loss: 1.003881:  53%|████▎   | 42/79 [01:52<00:31,  1.17it/s]Epoch 2 / 100; Avg_loss: 0.997932:  53%|████▎   | 42/79 [01:52<00:31,  1.17it/s]Epoch 2 / 100; Avg_loss: 0.997932:  54%|████▎   | 43/79 [01:53<00:31,  1.16it/s]Epoch 2 / 100; Avg_loss: 0.990023:  54%|████▎   | 43/79 [01:53<00:31,  1.16it/s]Epoch 2 / 100; Avg_loss: 0.990023:  56%|████▍   | 44/79 [01:54<00:29,  1.17it/s]Epoch 2 / 100; Avg_loss: 0.987218:  56%|████▍   | 44/79 [01:54<00:29,  1.17it/s]Epoch 2 / 100; Avg_loss: 0.987218:  57%|████▌   | 45/79 [01:55<00:28,  1.20it/s]Epoch 2 / 100; Avg_loss: 0.981386:  57%|████▌   | 45/79 [01:55<00:28,  1.20it/s]Epoch 2 / 100; Avg_loss: 0.981386:  58%|████▋   | 46/79 [01:56<00:28,  1.17it/s]Epoch 2 / 100; Avg_loss: 0.975334:  58%|████▋   | 46/79 [01:56<00:28,  1.17it/s]Epoch 2 / 100; Avg_loss: 0.975334:  59%|████▊   | 47/79 [01:57<00:27,  1.17it/s]Epoch 2 / 100; Avg_loss: 0.970714:  59%|████▊   | 47/79 [01:57<00:27,  1.17it/s]Epoch 2 / 100; Avg_loss: 0.970714:  61%|████▊   | 48/79 [01:57<00:26,  1.16it/s]Epoch 2 / 100; Avg_loss: 0.964711:  61%|████▊   | 48/79 [01:57<00:26,  1.16it/s]Epoch 2 / 100; Avg_loss: 0.964711:  62%|████▉   | 49/79 [01:58<00:25,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.961674:  62%|████▉   | 49/79 [01:58<00:25,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.961674:  63%|█████   | 50/79 [01:59<00:24,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.953659:  63%|█████   | 50/79 [01:59<00:24,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.953659:  65%|█████▏  | 51/79 [02:00<00:23,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.949439:  65%|█████▏  | 51/79 [02:00<00:23,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.949439:  66%|█████▎  | 52/79 [02:01<00:22,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.943031:  66%|█████▎  | 52/79 [02:01<00:22,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.943031:  67%|█████▎  | 53/79 [02:02<00:21,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.937680:  67%|█████▎  | 53/79 [02:02<00:21,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.937680:  68%|█████▍  | 54/79 [02:02<00:20,  1.19it/s]Epoch 2 / 100; Avg_loss: 0.930592:  68%|█████▍  | 54/79 [02:02<00:20,  1.19it/s]Epoch 2 / 100; Avg_loss: 0.930592:  70%|█████▌  | 55/79 [02:03<00:20,  1.17it/s]Epoch 2 / 100; Avg_loss: 0.922203:  70%|█████▌  | 55/79 [02:03<00:20,  1.17it/s]Epoch 2 / 100; Avg_loss: 0.922203:  71%|█████▋  | 56/79 [02:04<00:19,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.917480:  71%|█████▋  | 56/79 [02:04<00:19,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.917480:  72%|█████▊  | 57/79 [02:05<00:18,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.913388:  72%|█████▊  | 57/79 [02:05<00:18,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.913388:  73%|█████▊  | 58/79 [02:06<00:17,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.908053:  73%|█████▊  | 58/79 [02:06<00:17,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.908053:  75%|█████▉  | 59/79 [02:07<00:16,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.902069:  75%|█████▉  | 59/79 [02:07<00:16,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.902069:  76%|██████  | 60/79 [02:08<00:16,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.894456:  76%|██████  | 60/79 [02:08<00:16,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.894456:  77%|██████▏ | 61/79 [02:08<00:15,  1.19it/s]Epoch 2 / 100; Avg_loss: 0.889981:  77%|██████▏ | 61/79 [02:08<00:15,  1.19it/s]Epoch 2 / 100; Avg_loss: 0.889981:  78%|██████▎ | 62/79 [02:09<00:14,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.884724:  78%|██████▎ | 62/79 [02:09<00:14,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.884724:  80%|██████▍ | 63/79 [02:10<00:13,  1.17it/s]Epoch 2 / 100; Avg_loss: 0.878981:  80%|██████▍ | 63/79 [02:10<00:13,  1.17it/s]Epoch 2 / 100; Avg_loss: 0.878981:  81%|██████▍ | 64/79 [02:11<00:12,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.875079:  81%|██████▍ | 64/79 [02:11<00:12,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.875079:  82%|██████▌ | 65/79 [02:12<00:11,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.871162:  82%|██████▌ | 65/79 [02:12<00:11,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.871162:  84%|██████▋ | 66/79 [02:13<00:10,  1.19it/s]Epoch 2 / 100; Avg_loss: 0.866126:  84%|██████▋ | 66/79 [02:13<00:10,  1.19it/s]Epoch 2 / 100; Avg_loss: 0.866126:  85%|██████▊ | 67/79 [02:13<00:10,  1.19it/s]Epoch 2 / 100; Avg_loss: 0.860133:  85%|██████▊ | 67/79 [02:13<00:10,  1.19it/s]Epoch 2 / 100; Avg_loss: 0.860133:  86%|██████▉ | 68/79 [02:14<00:09,  1.19it/s]Epoch 2 / 100; Avg_loss: 0.855699:  86%|██████▉ | 68/79 [02:14<00:09,  1.19it/s]Epoch 2 / 100; Avg_loss: 0.855699:  87%|██████▉ | 69/79 [02:15<00:08,  1.19it/s]Epoch 2 / 100; Avg_loss: 0.852427:  87%|██████▉ | 69/79 [02:15<00:08,  1.19it/s]Epoch 2 / 100; Avg_loss: 0.852427:  89%|███████ | 70/79 [02:16<00:07,  1.20it/s]Epoch 2 / 100; Avg_loss: 0.847047:  89%|███████ | 70/79 [02:16<00:07,  1.20it/s]Epoch 2 / 100; Avg_loss: 0.847047:  90%|███████▏| 71/79 [02:17<00:06,  1.20it/s]Epoch 2 / 100; Avg_loss: 0.845117:  90%|███████▏| 71/79 [02:17<00:06,  1.20it/s]Epoch 2 / 100; Avg_loss: 0.845117:  91%|███████▎| 72/79 [02:18<00:05,  1.20it/s]Epoch 2 / 100; Avg_loss: 0.841715:  91%|███████▎| 72/79 [02:18<00:05,  1.20it/s]Epoch 2 / 100; Avg_loss: 0.841715:  92%|███████▍| 73/79 [02:18<00:05,  1.19it/s]Epoch 2 / 100; Avg_loss: 0.837088:  92%|███████▍| 73/79 [02:18<00:05,  1.19it/s]Epoch 2 / 100; Avg_loss: 0.837088:  94%|███████▍| 74/79 [02:19<00:04,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.832551:  94%|███████▍| 74/79 [02:19<00:04,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.832551:  95%|███████▌| 75/79 [02:20<00:03,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.826815:  95%|███████▌| 75/79 [02:20<00:03,  1.18it/s]Epoch 2 / 100; Avg_loss: 0.826815:  96%|███████▋| 76/79 [02:21<00:02,  1.19it/s]Epoch 2 / 100; Avg_loss: 0.821805:  96%|███████▋| 76/79 [02:21<00:02,  1.19it/s]Epoch 2 / 100; Avg_loss: 0.821805:  97%|███████▊| 77/79 [02:22<00:01,  1.20it/s]Epoch 2 / 100; Avg_loss: 0.817635:  97%|███████▊| 77/79 [02:22<00:01,  1.20it/s]Epoch 2 / 100; Avg_loss: 0.817635:  99%|███████▉| 78/79 [02:23<00:00,  1.20it/s]Epoch 2 / 100; Avg_loss: 0.812146:  99%|███████▉| 78/79 [02:23<00:00,  1.20it/s]Epoch 2 / 100; Avg_loss: 0.812146: 100%|████████| 79/79 [02:23<00:00,  1.43it/s]Epoch 2 / 100; Avg_loss: 0.806782: 100%|████████| 79/79 [02:23<00:00,  1.43it/s]Epoch 2 of 100 done in 66.91 seconds using learning rate: 2.00E-04
Avg loss of train: 0.806782
Avg loss of validation: nan, Angle_metric: 91.995605
Epoch 2 / 100; Avg_loss: 0.806782:   0%|         | 0/79 [02:28<00:55,  1.43it/s]Epoch 2 / 100; Avg_loss: 0.806782:   1%|         | 1/79 [02:29<03:02,  2.34s/it]Epoch 3 / 100; Avg_loss: 0.545412:   1%|         | 1/79 [02:29<03:02,  2.34s/it]Epoch 3 / 100; Avg_loss: 0.545412:   3%|▏        | 2/79 [02:30<02:25,  1.89s/it]Epoch 3 / 100; Avg_loss: 0.522744:   3%|▏        | 2/79 [02:30<02:25,  1.89s/it]Epoch 3 / 100; Avg_loss: 0.522744:   4%|▎        | 3/79 [02:31<01:59,  1.58s/it]Epoch 3 / 100; Avg_loss: 0.490568:   4%|▎        | 3/79 [02:31<01:59,  1.58s/it]Epoch 3 / 100; Avg_loss: 0.490568:   5%|▍        | 4/79 [02:32<01:41,  1.35s/it]Epoch 3 / 100; Avg_loss: 0.515714:   5%|▍        | 4/79 [02:32<01:41,  1.35s/it]Epoch 3 / 100; Avg_loss: 0.515714:   6%|▌        | 5/79 [02:33<01:28,  1.20s/it]Epoch 3 / 100; Avg_loss: 0.523703:   6%|▌        | 5/79 [02:33<01:28,  1.20s/it]Epoch 3 / 100; Avg_loss: 0.523703:   8%|▋        | 6/79 [02:33<01:20,  1.10s/it]Epoch 3 / 100; Avg_loss: 0.522204:   8%|▋        | 6/79 [02:33<01:20,  1.10s/it]Epoch 3 / 100; Avg_loss: 0.522204:   9%|▊        | 7/79 [02:34<01:13,  1.03s/it]Epoch 3 / 100; Avg_loss: 0.525362:   9%|▊        | 7/79 [02:34<01:13,  1.03s/it]Epoch 3 / 100; Avg_loss: 0.525362:  10%|▉        | 8/79 [02:35<01:12,  1.02s/it]Epoch 3 / 100; Avg_loss: nan:  10%|█▍            | 8/79 [02:35<01:12,  1.02s/it][0;31m---------------------------------------------------------------------------[0m
[0;31mInvalidArgumentError[0m                      Traceback (most recent call last)
[0;32m~/Desktop/IceCube_GNN/train_likelihood.py[0m in [0;36m<module>[0;34m[0m
[1;32m    229[0m     [0minputs[0m[0;34m,[0m [0mtargets[0m  [0;34m=[0m [0mbatch[0m[0;34m[0m[0;34m[0m[0m
[1;32m    230[0m     [0minputs[0m[0;34m[[0m[0;36m0[0m[0;34m][0m[0;34m[[0m[0;34m:[0m[0;34m,[0m [0;34m:[0m[0;36m3[0m[0;34m][0m [0;34m=[0m [0minputs[0m[0;34m[[0m[0;36m0[0m[0;34m][0m[0;34m[[0m[0;34m:[0m[0;34m,[0m [0;34m:[0m[0;36m3[0m[0;34m][0m [0;34m/[0m [0;36m1000[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 231[0;31m     [0mout[0m              [0;34m=[0m [0mtrain_step[0m[0;34m([0m[0minputs[0m[0;34m,[0m [0mtargets[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    232[0m     [0mloss[0m            [0;34m+=[0m [0mout[0m[0;34m[0m[0;34m[0m[0m
[1;32m    233[0m [0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py[0m in [0;36m__call__[0;34m(self, *args, **kwds)[0m
[1;32m    826[0m     [0mtracing_count[0m [0;34m=[0m [0mself[0m[0;34m.[0m[0mexperimental_get_tracing_count[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    827[0m     [0;32mwith[0m [0mtrace[0m[0;34m.[0m[0mTrace[0m[0;34m([0m[0mself[0m[0;34m.[0m[0m_name[0m[0;34m)[0m [0;32mas[0m [0mtm[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 828[0;31m       [0mresult[0m [0;34m=[0m [0mself[0m[0;34m.[0m[0m_call[0m[0;34m([0m[0;34m*[0m[0margs[0m[0;34m,[0m [0;34m**[0m[0mkwds[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    829[0m       [0mcompiler[0m [0;34m=[0m [0;34m"xla"[0m [0;32mif[0m [0mself[0m[0;34m.[0m[0m_experimental_compile[0m [0;32melse[0m [0;34m"nonXla"[0m[0;34m[0m[0;34m[0m[0m
[1;32m    830[0m       [0mnew_tracing_count[0m [0;34m=[0m [0mself[0m[0;34m.[0m[0mexperimental_get_tracing_count[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py[0m in [0;36m_call[0;34m(self, *args, **kwds)[0m
[1;32m    853[0m       [0;31m# In this case we have created variables on the first call, so we run the[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[1;32m    854[0m       [0;31m# defunned version which is guaranteed to never create variables.[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 855[0;31m       [0;32mreturn[0m [0mself[0m[0;34m.[0m[0m_stateless_fn[0m[0;34m([0m[0;34m*[0m[0margs[0m[0;34m,[0m [0;34m**[0m[0mkwds[0m[0;34m)[0m  [0;31m# pylint: disable=not-callable[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    856[0m     [0;32melif[0m [0mself[0m[0;34m.[0m[0m_stateful_fn[0m [0;32mis[0m [0;32mnot[0m [0;32mNone[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    857[0m       [0;31m# Release the lock early so that multiple threads can perform the call[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py[0m in [0;36m__call__[0;34m(self, *args, **kwargs)[0m
[1;32m   2940[0m       (graph_function,
[1;32m   2941[0m        filtered_flat_args) = self._maybe_define_function(args, kwargs)
[0;32m-> 2942[0;31m     return graph_function._call_flat(
[0m[1;32m   2943[0m         filtered_flat_args, captured_inputs=graph_function.captured_inputs)  # pylint: disable=protected-access
[1;32m   2944[0m [0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py[0m in [0;36m_call_flat[0;34m(self, args, captured_inputs, cancellation_manager)[0m
[1;32m   1916[0m         and executing_eagerly):
[1;32m   1917[0m       [0;31m# No tape is watching; skip to running the function.[0m[0;34m[0m[0;34m[0m[0;34m[0m[0m
[0;32m-> 1918[0;31m       return self._build_call_outputs(self._inference_function.call(
[0m[1;32m   1919[0m           ctx, args, cancellation_manager=cancellation_manager))
[1;32m   1920[0m     forward_backward = self._select_forward_and_backward_functions(

[0;32m~/anaconda3/lib/python3.8/site-packages/tensorflow/python/eager/function.py[0m in [0;36mcall[0;34m(self, ctx, args, cancellation_manager)[0m
[1;32m    553[0m       [0;32mwith[0m [0m_InterpolateFunctionError[0m[0;34m([0m[0mself[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    554[0m         [0;32mif[0m [0mcancellation_manager[0m [0;32mis[0m [0;32mNone[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 555[0;31m           outputs = execute.execute(
[0m[1;32m    556[0m               [0mstr[0m[0;34m([0m[0mself[0m[0;34m.[0m[0msignature[0m[0;34m.[0m[0mname[0m[0;34m)[0m[0;34m,[0m[0;34m[0m[0;34m[0m[0m
[1;32m    557[0m               [0mnum_outputs[0m[0;34m=[0m[0mself[0m[0;34m.[0m[0m_num_outputs[0m[0;34m,[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/tensorflow/python/eager/execute.py[0m in [0;36mquick_execute[0;34m(op_name, num_outputs, inputs, attrs, ctx, name)[0m
[1;32m     57[0m   [0;32mtry[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m     58[0m     [0mctx[0m[0;34m.[0m[0mensure_initialized[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0;32m---> 59[0;31m     tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
[0m[1;32m     60[0m                                         inputs, attrs, num_outputs)
[1;32m     61[0m   [0;32mexcept[0m [0mcore[0m[0;34m.[0m[0m_NotOkStatusException[0m [0;32mas[0m [0me[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;31mInvalidArgumentError[0m:  Input is not invertible.
	 [[node gradient_tape/MatrixInverse (defined at /home/johannbs/Desktop/IceCube_GNN/train_likelihood.py:155) ]] [Op:__inference_train_step_2699]

Errors may have originated from an input operation.
Input Source operations connected to node gradient_tape/MatrixInverse:
 diag (defined at /home/johannbs/Desktop/IceCube_GNN/loss_functions.py:101)

Function call stack:
train_step


[23;0t
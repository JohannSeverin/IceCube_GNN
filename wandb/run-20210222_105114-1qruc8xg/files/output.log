GPU detected
Loading data to memory
  0%|                                                   | 0/391 [00:00<?, ?it/s]  0%|                                           | 1/391 [00:05<38:10,  5.87s/it]Epoch 1 / 100; Avg_loss: inf:   0%|             | 1/391 [00:05<38:10,  5.87s/it]Epoch 1 / 100; Avg_loss: inf:   1%|             | 2/391 [00:07<28:53,  4.46s/it]Epoch 1 / 100; Avg_loss: nan:   1%|             | 2/391 [00:07<28:53,  4.46s/it]Epoch 1 / 100; Avg_loss: nan:   1%|             | 3/391 [00:08<22:24,  3.47s/it]Epoch 1 / 100; Avg_loss: nan:   1%|             | 3/391 [00:08<22:24,  3.47s/it]Epoch 1 / 100; Avg_loss: nan:   1%|▏            | 4/391 [00:09<17:50,  2.77s/it]Epoch 1 / 100; Avg_loss: nan:   1%|▏            | 4/391 [00:09<17:50,  2.77s/it]Epoch 1 / 100; Avg_loss: nan:   1%|▏            | 5/391 [00:10<14:35,  2.27s/it]Epoch 1 / 100; Avg_loss: nan:   1%|▏            | 5/391 [00:10<14:35,  2.27s/it]Epoch 1 / 100; Avg_loss: nan:   2%|▏            | 6/391 [00:11<12:41,  1.98s/it]Epoch 1 / 100; Avg_loss: nan:   2%|▏            | 6/391 [00:11<12:41,  1.98s/it][0;31m---------------------------------------------------------------------------[0m
[0;31mKeyboardInterrupt[0m                         Traceback (most recent call last)
[0;32m~/Desktop/IceCube_GNN/train_likelihood.py[0m in [0;36m<module>[0;34m[0m
[1;32m    221[0m [0;34m[0m[0m
[1;32m    222[0m [0;34m[0m[0m
[0;32m--> 223[0;31m [0;32mfor[0m [0mbatch[0m [0;32min[0m [0mloader_train[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    224[0m     [0minputs[0m[0;34m,[0m [0mtargets[0m  [0;34m=[0m [0mbatch[0m[0;34m[0m[0;34m[0m[0m
[1;32m    225[0m     [0minputs[0m[0;34m[[0m[0;36m0[0m[0;34m][0m[0;34m[[0m[0;34m:[0m[0;34m,[0m [0;34m:[0m[0;36m3[0m[0;34m][0m [0;34m=[0m [0minputs[0m[0;34m[[0m[0;36m0[0m[0;34m][0m[0;34m[[0m[0;34m:[0m[0;34m,[0m [0;34m:[0m[0;36m3[0m[0;34m][0m [0;34m/[0m [0;36m1000[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/spektral/data/loaders.py[0m in [0;36m__next__[0;34m(self)[0m
[1;32m     99[0m     [0;32mdef[0m [0m__next__[0m[0;34m([0m[0mself[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    100[0m         [0mnxt[0m [0;34m=[0m [0mself[0m[0;34m.[0m[0m_generator[0m[0;34m.[0m[0m__next__[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 101[0;31m         [0;32mreturn[0m [0mself[0m[0;34m.[0m[0mcollate[0m[0;34m([0m[0mnxt[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    102[0m [0;34m[0m[0m
[1;32m    103[0m     [0;32mdef[0m [0mgenerator[0m[0;34m([0m[0mself[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/spektral/data/loaders.py[0m in [0;36mcollate[0;34m(self, batch)[0m
[1;32m    277[0m [0;34m[0m[0m
[1;32m    278[0m     [0;32mdef[0m [0mcollate[0m[0;34m([0m[0mself[0m[0;34m,[0m [0mbatch[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 279[0;31m         [0mpacked[0m [0;34m=[0m [0mself[0m[0;34m.[0m[0mpack[0m[0;34m([0m[0mbatch[0m[0;34m,[0m [0mreturn_dict[0m[0;34m=[0m[0;32mTrue[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    280[0m         [0my[0m [0;34m=[0m [0;32mNone[0m[0;34m[0m[0;34m[0m[0m
[1;32m    281[0m         [0;32mif[0m [0;34m'y'[0m [0;32min[0m [0mself[0m[0;34m.[0m[0mdataset[0m[0;34m.[0m[0msignature[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/spektral/data/loaders.py[0m in [0;36mpack[0;34m(self, batch, return_dict)[0m
[1;32m    145[0m         [0moutput[0m [0;34m=[0m [0;34m[[0m[0mlist[0m[0;34m([0m[0melem[0m[0;34m)[0m [0;32mfor[0m [0melem[0m [0;32min[0m [0mzip[0m[0;34m([0m[0;34m*[0m[0;34m[[0m[0mg[0m[0;34m.[0m[0mnumpy[0m[0;34m([0m[0;34m)[0m [0;32mfor[0m [0mg[0m [0;32min[0m [0mbatch[0m[0;34m][0m[0;34m)[0m[0;34m][0m[0;34m[0m[0;34m[0m[0m
[1;32m    146[0m         [0;32mif[0m [0mreturn_dict[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 147[0;31m             [0mkeys[0m [0;34m=[0m [0;34m[[0m[0mk[0m [0;34m+[0m [0;34m'_list'[0m [0;32mfor[0m [0mk[0m [0;32min[0m [0mself[0m[0;34m.[0m[0mdataset[0m[0;34m.[0m[0msignature[0m[0;34m.[0m[0mkeys[0m[0;34m([0m[0;34m)[0m[0;34m][0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    148[0m             [0;32mreturn[0m [0;34m{[0m[0mk[0m[0;34m:[0m [0mv[0m [0;32mfor[0m [0mk[0m[0;34m,[0m [0mv[0m [0;32min[0m [0mzip[0m[0;34m([0m[0mkeys[0m[0;34m,[0m [0moutput[0m[0;34m)[0m[0;34m}[0m[0;34m[0m[0;34m[0m[0m
[1;32m    149[0m         [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/spektral/data/dataset.py[0m in [0;36msignature[0;34m(self)[0m
[1;32m    253[0m             [0msignature[0m[0;34m[[0m[0;34m'y'[0m[0;34m][0m [0;34m=[0m [0mdict[0m[0;34m([0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    254[0m             [0msignature[0m[0;34m[[0m[0;34m'y'[0m[0;34m][0m[0;34m[[0m[0;34m'spec'[0m[0;34m][0m [0;34m=[0m [0mget_spec[0m[0;34m([0m[0mgraph[0m[0;34m.[0m[0my[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 255[0;31m             [0msignature[0m[0;34m[[0m[0;34m'y'[0m[0;34m][0m[0;34m[[0m[0;34m'shape'[0m[0;34m][0m [0;34m=[0m [0;34m([0m[0mself[0m[0;34m.[0m[0mn_labels[0m[0;34m,[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    256[0m             [0msignature[0m[0;34m[[0m[0;34m'y'[0m[0;34m][0m[0;34m[[0m[0;34m'dtype'[0m[0;34m][0m [0;34m=[0m [0mtf[0m[0;34m.[0m[0mas_dtype[0m[0;34m([0m[0mnp[0m[0;34m.[0m[0marray[0m[0;34m([0m[0mgraph[0m[0;34m.[0m[0my[0m[0;34m)[0m[0;34m.[0m[0mdtype[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[1;32m    257[0m         [0;32mreturn[0m [0msignature[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/spektral/data/dataset.py[0m in [0;36mn_labels[0;34m(self)[0m
[1;32m    213[0m     [0;34m@[0m[0mproperty[0m[0;34m[0m[0;34m[0m[0m
[1;32m    214[0m     [0;32mdef[0m [0mn_labels[0m[0;34m([0m[0mself[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 215[0;31m         [0;32mif[0m [0mlen[0m[0;34m([0m[0mself[0m[0;34m.[0m[0mgraphs[0m[0;34m)[0m [0;34m==[0m [0;36m1[0m [0;32mor[0m [0mlen[0m[0;34m([0m[0mset[0m[0;34m([0m[0;34m[[0m[0mg[0m[0;34m.[0m[0mn_labels[0m [0;32mfor[0m [0mg[0m [0;32min[0m [0mself[0m[0;34m.[0m[0mgraphs[0m[0;34m][0m[0;34m)[0m[0;34m)[0m [0;34m==[0m [0;36m1[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    216[0m             [0;32mreturn[0m [0mself[0m[0;34m.[0m[0mgraphs[0m[0;34m[[0m[0;36m0[0m[0;34m][0m[0;34m.[0m[0mn_labels[0m[0;34m[0m[0;34m[0m[0m
[1;32m    217[0m         [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/spektral/data/dataset.py[0m in [0;36m<listcomp>[0;34m(.0)[0m
[1;32m    213[0m     [0;34m@[0m[0mproperty[0m[0;34m[0m[0;34m[0m[0m
[1;32m    214[0m     [0;32mdef[0m [0mn_labels[0m[0;34m([0m[0mself[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0;32m--> 215[0;31m         [0;32mif[0m [0mlen[0m[0;34m([0m[0mself[0m[0;34m.[0m[0mgraphs[0m[0;34m)[0m [0;34m==[0m [0;36m1[0m [0;32mor[0m [0mlen[0m[0;34m([0m[0mset[0m[0;34m([0m[0;34m[[0m[0mg[0m[0;34m.[0m[0mn_labels[0m [0;32mfor[0m [0mg[0m [0;32min[0m [0mself[0m[0;34m.[0m[0mgraphs[0m[0;34m][0m[0;34m)[0m[0;34m)[0m [0;34m==[0m [0;36m1[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    216[0m             [0;32mreturn[0m [0mself[0m[0;34m.[0m[0mgraphs[0m[0;34m[[0m[0;36m0[0m[0;34m][0m[0;34m.[0m[0mn_labels[0m[0;34m[0m[0;34m[0m[0m
[1;32m    217[0m         [0;32melse[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;32m~/anaconda3/lib/python3.8/site-packages/spektral/data/graph.py[0m in [0;36mn_labels[0;34m(self)[0m
[1;32m    115[0m             [0;32mreturn[0m [0;32mNone[0m[0;34m[0m[0;34m[0m[0m
[1;32m    116[0m [0;34m[0m[0m
[0;32m--> 117[0;31m     [0;34m@[0m[0mproperty[0m[0;34m[0m[0;34m[0m[0m
[0m[1;32m    118[0m     [0;32mdef[0m [0mn_labels[0m[0;34m([0m[0mself[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[1;32m    119[0m         [0;32mif[0m [0mself[0m[0;34m.[0m[0my[0m [0;32mis[0m [0;32mnot[0m [0;32mNone[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m

[0;31mKeyboardInterrupt[0m: 

[23;0t